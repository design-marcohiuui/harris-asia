
<div style="margin: 3rem 0 3rem 0;">
    <p class="container line" style="width: 20vw;height: .1rem; background-color: goldenrod;margin-bottom: .5rem;"></p>
    <p class="container line" style="width: 40vw;height: .1rem; background-color: goldenrod;margin-bottom: .5rem;"></p>
    <p class="container line" style="width: 30vw;height: .1rem; background-color: goldenrod;margin-bottom: 2rem;"></p>
</div>
<section class="hero has-background-white-ter" style="min-height: 72vh; padding-top: 5rem;">
    <ng-container *ngIf="(auth.user$ | async) || {} as user">
        <div *ngIf="user.uid" class="container-fluid has-text-centered is-family-sans-serif" style="margin: 3rem">
            <p class="is-size-5 is-family-sans-serif" style="margin-bottom: 2rem">帳號開通成功</p>
            <button class="button is-success is-outlined is-rounded" routerLink = "/">立即搶購</button>
        </div> 
        <div class="container">
            <form [formGroup]="signupForm" *ngIf="!user.uid" (ngSubmit)="signup()" style="margin: 3rem">
                <div class="container-fluid has-text-black">
                    <div class="field is-family-sans-serif">
                        <div class="has-text-centered has-text-weight-semibold">
                            <label class="is-size-5">新用戶註冊</label>
                        </div>
                        <div class="field">
                            <div class="label is-normal">
                                <label for="email">Email</label>
                            </div>
                            <div class="">
                                <p class="control is-expanded has-icons-left">
                                    <fa-icon [icon]="['fas','envelope']" class="icon is-small is-left"></fa-icon>
                                    <input class="input is-rounded" type="email" formControlName="email" required>
                                </p>
                                <div *ngIf="email.invalid && email.dirty" class="label help is-normal is-danger">
                                    <label for="invalidEmail">
                                        格式錯誤或{{ email.value }}已被使用
                                    </label> 
                                </div>
                                <div *ngIf="email.valid" class="label is-normal help is-success">
                                    <label for="validemail">
                                        {{ email.value }} 可用
                                    </label>
                                </div>
                                <div *ngIf="email.pending" class="label is-normal help is-info">
                                    Hold tight... 確認 {{ email.value }}
                                </div>
                            </div>
                        </div>
                        
                        <div class="field" style="margin-top: 2rem">
                            <div class="label is-normal">
                                <label for="displayName">用戶名</label>
                            </div>
                            <div class="">
                                <div class="content control is-expanded has-icons-left">
                                    <fa-icon [icon]="['fas','user']" class="icon is-small is-left"></fa-icon>
                                    <input class="input is-rounded" type="displayName" formControlName="displayName" required>
                                </div>
                                <div *ngIf="displayName.invalid && displayName.dirty" class="label help is-normal is-danger">
                                    <label for="invalidDisplayName">
                                        {{ displayName.value }} 已被使用
                                    </label>
                                </div>
                                <div *ngIf="displayName.valid" class="label is-normal help is-success">
                                    <label for="validDisplayName">
                                        {{ displayName.value }} 可用
                                    </label>
                                </div>
                                <div *ngIf="displayName.pending" class="label is-normal help is-info">
                                    Hold tight... 確認 {{ displayName.value }}
                                </div>
                            </div>                        
                        </div>
                        <div class="field" style="margin-top: 2rem">
                            <div class="label is-normal">
                                <label for="password">密碼</label>
                            </div>
                            <div class="">
                                <div class="content control is-expanded has-icons-left">
                                    <input class="input is-rounded" type="password" formControlName="password" required>
                                    <fa-icon [icon]="['fas','lock']" class="icon is-small is-left"></fa-icon>
                                </div>
                                <div *ngIf="password.invalid && password.touched" class="label help is-normal is-danger">
                                    <label for="invalidPassword">
                                        密碼須介於6-24個英數字元
                                    </label>
                                </div>
                                <div *ngIf="signupForm.valid" class="label is-normal help is-success">
                                    <label for="vaildSignup">
                                        請按送出以完成
                                    </label>
                                </div>
                            </div>                        
                        </div>
                        
                        <div class="control is-right is-family-sans-serif" style="margin-top: 2rem">
                            <button class="button is-pulled-right is-rounded" type="submit" [disabled]="!signupForm.valid" (click)="signup()">
                                送出
                            </button>
                            <button class="button is-rounded" (click)="auth.googleSignin()">
                                <fa-icon [icon]="['fab','google']" class="icon is-small is-left"></fa-icon>
                                <p>登入並註冊</p> 
                            </button>
                        </div>
                    </div>
                </div>
            </form>
        </div>          
    </ng-container>
</section>
<script src="https://kit.fontawesome.com/3ab715c41f.js"></script>
